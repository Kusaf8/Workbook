<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>NCAA_Project.knit</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.5.1/jquery-3.5.1.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Solutions</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">More About Me</a>
</li>
<li>
  <a href="tradecraft.html">Tradecraft</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R Studio
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="R.html">Data Minning RSS Feeds</a>
    </li>
    <li>
      <a href="NCAA_Project_ref.html">NCAA Final Four Project</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Python
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="R.html">Banking Fraud Study</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Microsoft Excel
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="excel.html">Stocks Project</a>
    </li>
  </ul>
</li>
<li>
  <a href="access.html">Microsoft Access</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://www.linkedin.com/in/kevin-r-a4789a77">
    <span class="fa fa-linkedin"></span>
     
  </a>
</li>
<li>
  <a href="kevin.a.roberts8@gmail.com">
    <span class="fa fa-mail"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<pre class="r"><code>Packages &lt;- c(&quot;maps&quot;, &quot;plyr&quot;, &quot;googleVis&quot;, &quot;gsubfn&quot;, &quot;rvest&quot;,
              &quot;tm&quot;, &quot;stringr&quot;, &quot;dplyr&quot;, &quot;tidyverse&quot;, &quot;caret&quot;,
              &quot;corrplot&quot;, &quot;DescTools&quot;, &quot;rlist&quot;, &quot;class&quot;)
invisible(lapply(lapply(Packages, rlang::quo_name),
                 library, character.only = TRUE))</code></pre>
<pre><code>## Warning: package &#39;maps&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Warning: package &#39;plyr&#39; was built under R version 3.6.3</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:maps&#39;:
## 
##     ozone</code></pre>
<pre><code>## Creating a generic function for &#39;toJSON&#39; from package &#39;jsonlite&#39; in package &#39;googleVis&#39;</code></pre>
<pre><code>## 
## Welcome to googleVis version 0.6.11
## 
## Please read Google&#39;s Terms of Use
## before you start using the package:
## https://developers.google.com/terms/
## 
## Note, the plot method of googleVis will by default use
## the standard browser to display its output.
## 
## See the googleVis package vignettes for more details,
## or visit https://mages.github.io/googleVis/.
## 
## To suppress this message use:
## suppressPackageStartupMessages(library(googleVis))</code></pre>
<pre><code>## Warning: package &#39;gsubfn&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Loading required package: proto</code></pre>
<pre><code>## Warning: package &#39;proto&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Warning: package &#39;rvest&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Warning: package &#39;tm&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Loading required package: NLP</code></pre>
<pre><code>## Warning: package &#39;NLP&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Warning: package &#39;stringr&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 3.6.3</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:plyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## Warning: package &#39;tidyverse&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Warning in (function (kind = NULL, normal.kind = NULL, sample.kind = NULL) :
## non-uniform &#39;Rounding&#39; sampler used</code></pre>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --</code></pre>
<pre><code>## v ggplot2 3.3.5     v readr   1.4.0
## v tibble  3.1.1     v purrr   0.3.4
## v tidyr   1.1.3     v forcats 0.5.1</code></pre>
<pre><code>## Warning in (function (kind = NULL, normal.kind = NULL, sample.kind = NULL) :
## non-uniform &#39;Rounding&#39; sampler used</code></pre>
<pre><code>## Warning: package &#39;tibble&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Warning: package &#39;tidyr&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Warning: package &#39;readr&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Warning: package &#39;purrr&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Warning: package &#39;forcats&#39; was built under R version 3.6.3</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x ggplot2::annotate()     masks NLP::annotate()
## x dplyr::arrange()        masks plyr::arrange()
## x purrr::compact()        masks plyr::compact()
## x dplyr::count()          masks plyr::count()
## x dplyr::failwith()       masks plyr::failwith()
## x dplyr::filter()         masks stats::filter()
## x readr::guess_encoding() masks rvest::guess_encoding()
## x dplyr::id()             masks plyr::id()
## x dplyr::lag()            masks stats::lag()
## x purrr::map()            masks maps::map()
## x dplyr::mutate()         masks plyr::mutate()
## x dplyr::rename()         masks plyr::rename()
## x dplyr::summarise()      masks plyr::summarise()
## x dplyr::summarize()      masks plyr::summarize()</code></pre>
<pre><code>## Warning: package &#39;caret&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## 
## Attaching package: &#39;caret&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     lift</code></pre>
<pre><code>## Warning: package &#39;corrplot&#39; was built under R version 3.6.3</code></pre>
<pre><code>## corrplot 0.84 loaded</code></pre>
<pre><code>## Warning: package &#39;DescTools&#39; was built under R version 3.6.3</code></pre>
<pre><code>## 
## Attaching package: &#39;DescTools&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:caret&#39;:
## 
##     MAE, RMSE</code></pre>
<pre><code>## Warning: package &#39;rlist&#39; was built under R version 3.6.3</code></pre>
<pre class="r"><code>## Primary Scraping Function for data from sports-reference.com##
Data.Scrape = function(years) {
  result = list()
  for (year in years){
  webpage = sprintf(&quot;https://www.sports-reference.com/cbb/seasons/%s-advanced-school-stats.html&quot;, year)
  wp = read_html(webpage)
  
  a = wp %&gt;% html_node(&quot;p:nth-child(1)&quot;)
  temp.a = data.frame(Year = html_text(a))
  
  b = wp %&gt;% html_nodes(&quot;td.left&quot;)
  temp.b = data.frame(Team = html_text(b))
  
  temp.c = as.numeric(html_text(wp %&gt;% html_nodes(&quot;td.right&quot;)))
  temp.c = matrix(temp.c, nrow = nrow(temp.b), ncol = length(temp.c)/nrow(temp.b), byrow = TRUE)

  MM.TrainTest = str_detect(as.matrix(temp.b),&quot;NCAA&quot;)
  MM.TrainTest = data.frame(MM.TrainTest)
  
  data.temp = data.frame(temp.a, temp.b,MM.TrainTest, temp.c)
  data.temp$Team = str_replace(data.temp$Team, &quot;NCAA&quot;, &quot;&quot;)
  data.temp$Team = str_trim(data.temp$Team, side = &quot;right&quot;)
  data.temp$MM.TrainTest = as.factor(data.temp$MM.TrainTest)

  ## Pulling the Final Four teams data from each season. Not all pages are the same##
  ## Matching the Final Four dataset to create a new TestTrain column variable for modeling ##
  for (h in 1:7){
    text.str = sprintf(&quot;p:nth-child(%s)&quot;, h)
    find = wp %&gt;% html_element(text.str) %&gt;% html_text()
    text.find = strapply(find, &quot;Final Four&quot;, empty = FALSE, simplify = TRUE)
    if (text.find == &quot;Final Four&quot;)
      n = h
  }
  
  ## Text transformation and hard coding to extrapolate the Final Four Teams ##
  text.str = sprintf(&quot;p:nth-child(%s)&quot;, n)
  text = wp %&gt;% html_element(text.str) %&gt;% html_text()
  text = unlist(strsplit(text, &quot;,&quot;))
  text = unlist(strsplit(text, &quot;and&quot;))
  text = unlist(strsplit(text, &quot;:&quot;))
  text = trimws(text, &quot;l&quot;)
  text = trimws(text, &quot;r&quot;)
  FF = data.frame(text)
  FF.Text = gsub(&quot;UConn&quot;, &quot;Connecticut&quot;, FF$text)
  FF2 = data.frame(FF.Text)
  FF.Text2 = gsub(&quot;UNC&quot;, &quot;North Carolina&quot;, FF2$FF.Text)
  FF3 = data.frame(FF.Text2)
  
  ## For Loop to add Test and Training column variable ##
  data.temp$FF = FALSE
  for (i in 1:length(data.temp$Team)) {
    for (j in 1:length(FF3$FF.Text2)) {
      if (data.temp$Team[i] == FF3$FF.Text2[j])
        data.temp$FF[i] = TRUE
    }
  }
}
  return(data.temp)
}

################################################################################
## Running Function and binding data ##
year.string = as.character(seq.int(2011, 2021, 1))
Main.data = list.rbind(lapply(year.string, FUN = Data.Scrape))

################################################################################
## Applying the appropriate Column Headings for the data ##
webpage = sprintf(&quot;https://www.sports-reference.com/cbb/seasons/%s-advanced-school-stats.html&quot;, 2021)
wp.2 = read_html(webpage)
temp.d = matrix(html_text(wp.2 %&gt;% html_nodes(&quot;.poptip&quot;)), nrow = 1)
colnames(Main.data)[4:35] = temp.d[3:34]
Main.data$FF.TrainTest  = as.factor(Main.data$FF)
Main.data = Main.data %&gt;% 
  relocate(FF.TrainTest, .after = MM.TrainTest) %&gt;%
  select(-FF)
emptycols = sapply(Main.data, function(k) all(is.na(k)))
Main.data &lt;- Main.data[!emptycols]

################################################################################
## Preprocessing of Data ##
Main.data$FF.TrainTest = revalue(Main.data$FF.TrainTest, c(&quot;TRUE&quot; = &quot;1&quot;, &quot;FALSE&quot; = &quot;0&quot;))
Main.data$MM.TrainTest = revalue(Main.data$MM.TrainTest, c(&quot;TRUE&quot; = &quot;1&quot;, &quot;FALSE&quot; = &quot;0&quot;))
Main.data = Main.data %&gt;%
  filter(Year != &quot;2020-21 Season Pages&quot;)%&gt;%
  filter(W.1 != &quot;NA&quot;)

## Subset of Teams that made the Tournament&#39;MM.TestTrain&#39; factored dataset ##
MM.Teams = Main.data %&gt;%
  filter(MM.TrainTest == &quot;1&quot;)

Final4.Teams = Main.data %&gt;%
  filter(FF.TrainTest == &quot;1&quot;)

## Building Bar Chart of Teams who made it to the Championship Tournament ##
Main.data.cat = Main.data[1:4]
Main.data.num = Main.data[5:31]
round(prop.table(table(Main.data.cat$MM.TrainTest)), 2) * 100</code></pre>
<pre><code>## 
##  0  1 
## 82 18</code></pre>
<pre class="r"><code>Contenders = Main.data.cat %&gt;%
  filter(MM.TrainTest == &quot;1&quot;)
Contenders = data.frame(table(Contenders$Team))
Contenders = Contenders[order(-Contenders[,2]),]

plot(gvisBarChart(Contenders,
                  options = list(chartArea =&quot;{left:150,top:50,width:\&quot;50%\&quot;,height:\&quot;75%\&quot;}&quot;,
                                 width =&quot;1500px&quot;, 
                                 height=&quot;500px&quot;,
                                 title = &quot;Champion Teams&quot;,
                                 vAxis = &quot;{title:&#39;Teams&#39;,textStyle:{fontSize:12}}&quot;,
                                 hAxis = &quot;{title:&#39;Tournament Appearances&#39;}&quot;)))</code></pre>
<pre><code>## starting httpd help server ...</code></pre>
<pre><code>##  done</code></pre>
<pre class="r"><code>################################################################################
### Correlation Chart ###
cor.mtest &lt;- function(mat, ...) {
  mat &lt;- as.matrix(mat)
  n &lt;- ncol(mat)
  p.mat&lt;- matrix(NA, n, n)
  diag(p.mat) &lt;- 0
  for (i in 1:(n - 1)) {
    for (j in (i + 1):n) {
      tmp &lt;- cor.test(mat[, i], mat[, j], ...)
      p.mat[i, j] &lt;- p.mat[j, i] &lt;- tmp$p.value
    }
  }
  colnames(p.mat) &lt;- rownames(p.mat) &lt;- colnames(mat)
  p.mat
}

p.mat = cor.mtest(Main.data.num)
col &lt;- colorRampPalette(c(&quot;#BB4444&quot;, &quot;#EE9988&quot;, &quot;#FFFFFF&quot;, &quot;#77AADD&quot;, &quot;#4477AA&quot;))
corrplot(cor(Main.data.num), 
         col=col(200), order = &quot;hclust&quot;,type = &quot;upper&quot;,
         tl.col=&quot;black&quot;, tl.srt = 90, tl.cex = .75,
         title = &quot;Correlation Plot w/ P-Value of .01&quot;
         ,p.mat = p.mat, 
         sig.level = 0.01, 
         insig = &quot;blank&quot;)</code></pre>
<p><img src="NCAA_Project_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<pre class="r"><code># Correlation ##
Coer.data = Main.data[4:31]
for (i in 1:ncol(Coer.data)){
  j = colnames(Coer.data[i])
  ContCoef = ContCoef(Coer.data[[i]], Coer.data[[1]])
  if(ContCoef &gt; .1) 
    cat(j, &#39;=&#39;, ContCoef, &#39;\n&#39;)
}</code></pre>
<pre><code>## FF.TrainTest = 0.7071068 
## G = 0.6120975 
## W = 0.5240749 
## L = 0.2827296 
## W-L% = 0.642943 
## SRS = 0.7019111 
## SOS = 0.6428114 
## W.1 = 0.1939721 
## L.1 = 0.1555932 
## W.2 = 0.1902819 
## L.2 = 0.166368 
## W.3 = 0.1194848 
## L.3 = 0.2425233 
## Tm. = 0.650737 
## Opp. = 0.5138337 
## Pace = 0.2305413 
## ORtg = 0.4296286 
## FTr = 0.2718087 
## 3PAr = 0.2616265 
## TS% = 0.2920251 
## TRB% = 0.2950184 
## AST% = 0.234805 
## STL% = 0.2383972 
## BLK% = 0.3753427 
## eFG% = 0.3091816 
## TOV% = 0.2792449 
## ORB% = 0.3533668 
## FT/FGA = 0.2581299</code></pre>
<pre class="r"><code>Model.ds = Main.data[c(&quot;Year&quot;,&quot;Team&quot;,&quot;MM.TrainTest&quot;,&quot;FF.TrainTest&quot;, &quot;W-L%&quot;,&quot;SRS&quot;,&quot;SOS&quot;,&quot;Tm.&quot;,&quot;Opp.&quot;,&quot;ORtg&quot;)]

################################################################################
### The top five winning teams for the past 10 seasons ###
ggplot(Main.data, aes(x = W)) + 
  geom_histogram(binwidth = 5, fill=&quot;#69b3a2&quot;, color=&quot;#e9ecef&quot;, alpha=0.9) +
  ggtitle(&quot;Histogram of Team Wins&quot;)</code></pre>
<p><img src="NCAA_Project_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<pre class="r"><code>Model.ds1 = Model.ds %&gt;%
  filter(MM.TrainTest == &quot;1&quot;)

Top.Win.Teams = Model.ds1[order(-Model.ds1[,6] ),]
Top.5.Teams = head(Top.Win.Teams, 5)
Bottom.5.Teams = tail(Top.Win.Teams, 5)
TopBottom.5.Teams = rbind(Top.5.Teams, Bottom.5.Teams)
view(TopBottom.5.Teams)
plot(gvisBubbleChart(TopBottom.5.Teams,idvar = &quot;Team&quot;,xvar = &quot;W-L%&quot;, 
                     yvar =&quot;Tm.&quot;,colorvar = &quot;Opp.&quot;,sizevar = &quot;FF.TrainTest&quot;,
                     options=list(chartArea =&quot;{left:150,top:50,width:\&quot;50%\&quot;,height:\&quot;75%\&quot;}&quot;,
                                  width =&quot;1500px&quot;, height=&quot;500px&quot;,
                                  title = &quot;Top 5 and Bottom 5 Teams by Wins who Played in the Tournament&quot;,
                                  titlePosition = &#39;out&#39;,
                                  vAxis = &quot;{title:&#39;Total Team Points&#39;}&quot;,
                                  hAxis = &quot;{title:&#39;Win and Loss Percentage&#39;}&quot;,
                                  chartArea =&quot;{left:150,top:50,width:\&quot;50%\&quot;,height:\&quot;75%\&quot;}&quot;,
                                  width =&quot;1500px&quot;, height=&quot;500px&quot;,
                                  bubble = &quot;{textStyle:{color:&#39;black&#39;, fontSize: 8}}&quot;,
                                  colorAxis = &quot;{colors:[&#39;grey&#39;, &#39;blue&#39;]}&quot;)))

################################################################################
### Build of Model ###    
# Normalizing Data for Model #
normalize = function(x){
  return((x - min(x)) / (max(x) - min(x)))}
Model.subset = Model.ds[c(&quot;MM.TrainTest&quot;, &quot;W-L%&quot;,&quot;SRS&quot;,&quot;SOS&quot;,&quot;Tm.&quot;,&quot;Opp.&quot;,&quot;ORtg&quot;)]
Model.ds.subset = as.data.frame(lapply(Model.subset[2:6], normalize))
dat.d = sample(1:nrow(Model.ds.subset), size = nrow(Model.ds.subset) * 0.7, replace=FALSE)

train.dataset = Model.subset[dat.d,]
test.dataset = Model.subset[-dat.d,]
train.dataset.label = Model.subset[dat.d,1]
test.dataset.label = Model.subset[-dat.d,1]

## Classification Results using KNN modeling ##
set.seed(20210427)

# For Loop to identify the best k value to use for the best results #
a = train.dataset
b = test.dataset
c = train.dataset.label
i = 1 
k.optm = 1
for (i in 1:28){
  knn.mod = knn(train = a, test = b, cl = c, k = i)
  k.optm[i] = 100 * sum(c == knn.mod) / NROW(c)
  k = i
  cat(k, &#39;=&#39;, k.optm[i], &#39;\n&#39;)
}</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## Warning in is.na(e1) | is.na(e2): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 1 = 71.79697</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 2 = 71.79697</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 3 = 74.21203</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 4 = 73.35244</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 5 = 74.62137</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 6 = 73.76177</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 7 = 74.4167</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 8 = 74.49857</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 9 = 74.21203</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 10 = 74.4167</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 11 = 74.2939</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 12 = 74.25297</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 13 = 74.5395</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 14 = 74.6623</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 15 = 74.5395</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 16 = 74.62137</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 17 = 74.70323</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 18 = 74.94883</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 19 = 74.94883</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 20 = 74.70323</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 21 = 74.74417</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 22 = 74.6623</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 23 = 74.6623</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 24 = 74.5395</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 25 = 74.70323</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 26 = 74.62137</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 27 = 74.6623</code></pre>
<pre><code>## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length

## Warning in `==.default`(c, knn.mod): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## 28 = 74.33483</code></pre>
<pre class="r"><code>plot(k.optm, type = &quot;b&quot;, 
     xlab = &quot;K - Value&quot;, 
     ylab = &quot;Accuracy level&quot;, 
     main = &quot;Maximum Percentage Accuracy Graph&quot;)</code></pre>
<p><img src="NCAA_Project_files/figure-html/unnamed-chunk-1-3.png" width="672" /></p>
<pre class="r"><code>set.seed(20210427)
knn.pred = knn(train = a, test = b, cl = c, k = 24, prob = T)
table(knn.pred, test.dataset.label)</code></pre>
<pre><code>##         test.dataset.label
## knn.pred   0   1
##        0 830  89
##        1  38  91</code></pre>
<pre class="r"><code>confusionMatrix(table(knn.pred, test.dataset.label))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##         test.dataset.label
## knn.pred   0   1
##        0 830  89
##        1  38  91
##                                          
##                Accuracy : 0.8788         
##                  95% CI : (0.8575, 0.898)
##     No Information Rate : 0.8282         
##     P-Value [Acc &gt; NIR] : 3.691e-06      
##                                          
##                   Kappa : 0.5202         
##                                          
##  Mcnemar&#39;s Test P-Value : 9.131e-06      
##                                          
##             Sensitivity : 0.9562         
##             Specificity : 0.5056         
##          Pos Pred Value : 0.9032         
##          Neg Pred Value : 0.7054         
##              Prevalence : 0.8282         
##          Detection Rate : 0.7920         
##    Detection Prevalence : 0.8769         
##       Balanced Accuracy : 0.7309         
##                                          
##        &#39;Positive&#39; Class : 0              
## </code></pre>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
